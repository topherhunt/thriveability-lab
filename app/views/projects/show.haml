.row
  .col-sm-8
    %div
      %span.h1= @project.title
      - if @project.owner == current_user
        &nbsp;
        = link_to fa_icon("pencil"), edit_project_path(@project), class: "edit-project"
    %h4= @project.subtitle

    %table.table
      %tr
        %th Owner
        %td= link_to @project.owner.full_name, user_path(@project.owner)
      %tr
        %th Based in
        %td= @project.location
      %tr
        %th Stage
        %td= @project.stage
      %tr
        %th Tags
        %td
          - @project.tag_list.each do |name|
            = link_to name, projects_path(tags: name), class: "label label-default"

    %hr

    %h4 Introduction
    %p
      - if @project.introduction.present?
        = @project.introduction
      - else
        No introduction yet.
        - if @project.owner == current_user
          = link_to "Write one", edit_project_path(@project)

    %h4 Quadrants
    .row
      .col-sm-6{style: "max-height: 100px; overflow: auto;"}
        %strong Vision:
        = @project.quadrant_ul
      .col-sm-6{style: "max-height: 100px; overflow: auto;"}
        %strong Goals:
        = @project.quadrant_ur
    .row{style: "padding-top: 10px;"}
      .col-sm-6{style: "max-height: 100px; overflow: auto;"}
        %strong Community:
        = @project.quadrant_ll
      .col-sm-6{style: "max-height: 100px; overflow: auto;"}
        %strong Context:
        = @project.quadrant_lr

    %h4 Resources & links
    - if @project.resources.any?
      %ul
        - @project.resources.each do |resource|
          = render partial: "resources/show_li", locals: { resource: resource }
      - if current_user == @project.owner
        %p= link_to "Add another resource", new_resource_path(resource: { target_type: "Project", target_id: @project.id })
    - else
      %p
        No resources connected to this project yet.
        - if current_user == @project.owner
          Use this space to add any links or documents relevant to this project, that could be useful to other community members. #{link_to "Add a resource", new_resource_path(resource: { target_type: "Project", target_id: @project.id })}

  .col-sm-4
    = image_tag @project.image.url(:medium), style: "width: 100%; max-width: 300px;"

    %hr
    %h4 Get connected

    = render partial: "shared/likes_section", locals: { target: @project, link_wording: "This inspires me" }
    = render partial: "shared/stay_informed_flags_section", locals: { target: @project, owner: @project.owner, link_wording: "Keep me informed" }

    %p.get-involved
      - if current_user and GetInvolvedFlag.where(user: current_user, target: @project).any?
        = link_to fa_icon("child") + "&nbsp; I want to get involved".html_safe, get_involved_flag_path("Project", @project), method: :delete, class: "btn btn-default active"
      - else
        = link_to fa_icon("child") + "&nbsp; I want to get involved".html_safe, get_involved_flag_path("Project", @project), method: :post, class: "btn btn-info"
      - get_involved_flags = GetInvolvedFlag.where(target: @project).includes(:user)
      - if get_involved_flags.size > 0
        &nbsp;
        %span.badge.get-involved-flags-count.js-tooltip{"data-tooltip": get_involved_flags.first(10).map{ |f| f.user.full_name }.compact.join(", ")}= get_involved_flags.size

    - if @project.call_to_action.present?
      %hr
      %h4 How you can help
      %p= @project.call_to_action

    %hr
    %p.text-center
      Questions? Ideas? Feedback? Want to pitch in?
      = link_to fa_icon("envelope") + " Send #{@project.owner.first_name} an email", new_message_path(message: { project_id: @project.id, recipient_id: @project.owner_id }), class: "new-project-message-link nowrap"
